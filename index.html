<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PoupanÃ§a & Meal Prep</title>

<link rel="manifest" href="manifest.json" />

<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: #f6f7f8;
}
header {
  background: #111;
  color: #fff;
  padding: 16px;
  font-size: 18px;
  font-weight: 600;
}
.container {
  padding: 16px;
}
.card {
  background: #fff;
  border-radius: 10px;
  padding: 12px;
  margin-bottom: 12px;
}
.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
button {
  border: none;
  padding: 10px 14px;
  border-radius: 8px;
  font-weight: 600;
}
.btn-main { background:#111;color:#fff }
.btn-secondary { background:#eee }
.btn-danger { background:#ffdddd }
.btn-row { display:flex; gap:8px; margin-top:12px }

.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display:flex;
  align-items:center;
  justify-content:center;
}
.modal-content {
  background:#fff;
  padding:16px;
  border-radius:12px;
  width:90%;
  max-width:420px;
}
.form-group { margin-bottom:12px }
input, select {
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
}
small { color:#666 }
</style>
</head>

<body>
<header>ðŸ¥˜ PoupanÃ§a & Meal Prep</header>
<div id="root"></div>

<script type="text/babel">

function App() {
  const [items, setItems] = React.useState(
    JSON.parse(localStorage.getItem("items")) || []
  );
  const [showAdd, setShowAdd] = React.useState(false);
  const [newItem, setNewItem] = React.useState({
    nome: "", categoria: "ProteÃ­na", quantidade: "", estado: "cru"
  });

  React.useEffect(() => {
    localStorage.setItem("items", JSON.stringify(items));
  }, [items]);

  function addItem() {
    if (!newItem.nome) return;
    setItems([...items, { ...newItem, id: Date.now() }]);
    setNewItem({ nome:"", categoria:"ProteÃ­na", quantidade:"", estado:"cru" });
    setShowAdd(false);
  }

  function consumeItem(id) {
    setItems(items.filter(i => i.id !== id));
  }

  const categorias = ["ProteÃ­na","Hidratos","Leguminosas","Vegetais","Extras"];

  return (
    <div className="container">

      <button className="btn-main" onClick={() => setShowAdd(true)}>
        âž• Adicionar alimento
      </button>

      {categorias.map(cat => (
        <div key={cat} className="card">
          <h3>{cat}</h3>
          {items.filter(i => i.categoria === cat).length === 0 && (
            <small>Nenhum item</small>
          )}
          {items.filter(i => i.categoria === cat).map(i => (
            <div key={i.id} className="item">
              <div>
                <b>{i.nome}</b><br/>
                <small>{i.quantidade} Â· {i.estado}</small>
              </div>
              <button className="btn-danger" onClick={() => consumeItem(i.id)}>
                Consumido
              </button>
            </div>
          ))}
        </div>
      ))}

      {showAdd && (
        <div className="modal" onClick={() => setShowAdd(false)}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <h2>Novo alimento</h2>

            <div className="form-group">
              <input placeholder="Nome"
                value={newItem.nome}
                onChange={e => setNewItem({...newItem, nome:e.target.value})}/>
            </div>

            <div className="form-group">
              <select value={newItem.categoria}
                onChange={e => setNewItem({...newItem, categoria:e.target.value})}>
                {categorias.map(c => <option key={c}>{c}</option>)}
              </select>
            </div>

            <div className="form-group">
              <input placeholder="Quantidade (ex: 500g, 3 un.)"
                value={newItem.quantidade}
                onChange={e => setNewItem({...newItem, quantidade:e.target.value})}/>
            </div>

            <div className="form-group">
              <select value={newItem.estado}
                onChange={e => setNewItem({...newItem, estado:e.target.value})}>
                <option value="cru">Cru</option>
                <option value="cozinhado">Cozinhado</option>
                <option value="aberto">Aberto</option>
              </select>
            </div>

            <div className="btn-row">
              <button className="btn-secondary" onClick={()=>setShowAdd(false)}>Cancelar</button>
              <button className="btn-main" onClick={addItem}>Guardar</button>
            </div>
          </div>
        </div>
      )}

    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}

</script>
</body>
</html>
