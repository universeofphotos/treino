<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Poupan√ßa Holanda">
    <title>Poupan√ßa na Holanda</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 0;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px 20px;
            border-radius: 0 0 20px 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 13px;
            color: #666;
        }
        
        .btn-primary {
            background: #27ae60;
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            margin-bottom: 12px;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary:active {
            transform: scale(0.98);
        }
        
        .btn-scan {
            background: #9b59b6;
            box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3);
        }
        
        .suggestion-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .suggestion-box.no-cook {
            border-left: 4px solid #27ae60;
        }
        
        .suggestion-box.warning {
            border-left: 4px solid #f39c12;
        }
        
        .suggestion-box.urgent {
            border-left: 4px solid #e74c3c;
        }
        
        .suggestion-box h2 {
            font-size: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .recipe-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .recipe-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .recipe-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .recipe-origin {
            font-size: 12px;
            color: #9b59b6;
            font-weight: 500;
        }
        
        .recipe-cost {
            text-align: right;
        }
        
        .cost-total {
            font-size: 20px;
            font-weight: bold;
            color: #27ae60;
        }
        
        .cost-dose {
            font-size: 12px;
            color: #666;
        }
        
        .recipe-info {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #666;
        }
        
        .recipe-info span {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .category {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .category h3 {
            font-size: 15px;
            color: #2c3e50;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-name {
            font-weight: 500;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .item-details {
            font-size: 12px;
            color: #666;
        }
        
        .badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .badge-urgent {
            background: #e74c3c;
            color: white;
        }
        
        .badge-warning {
            background: #f39c12;
            color: white;
        }
        
        .badge-ok {
            background: #27ae60;
            color: white;
        }
        
        .badge-safe {
            background: #95a5a6;
            color: white;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            cursor: pointer;
            border: none;
            background: none;
            color: #666;
        }
        
        .nav-item.active {
            color: #667eea;
        }
        
        .nav-icon {
            font-size: 24px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-header h2 {
            font-size: 20px;
        }
        
        .btn-close {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 32px;
            height: 32px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: #2c3e50;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .btn-row {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            flex: 1;
            padding: 12px;
            border: 1px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .btn-submit {
            flex: 1;
            padding: 12px;
            border: none;
            background: #667eea;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 8px;
        }
        
        #reader {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .scanner-info {
            text-align: center;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // =======================
        // BASE DE DADOS DE RECEITAS
        // =======================
        const RECEITAS_BASE = [
            {
                id: 1,
                nome: "Feij√£o Moldavo Simples",
                origem: "Moldava",
                ingredientes: [
                    { nome: "Feij√£o cozido (lata)", quantidade: 400, unidade: "g" },
                    { nome: "Cebola", quantidade: 1, unidade: "unidade" },
                    { nome: "√ìleo", quantidade: 2, unidade: "colheres" },
                    { nome: "Sal", quantidade: "a gosto" }
                ],
                doses: 3,
                tempo: 5,
                duracao_frigo: 3,
                custo_estimado: 1.50,
                instrucoes: [
                    "Abrir a lata de feij√£o e escorrer",
                    "Cortar a cebola em peda√ßos pequenos",
                    "Misturar feij√£o + cebola + √≥leo + sal",
                    "Pode comer frio ou morno"
                ],
                tags: ["minimalista", "moldava", "frio"]
            },
            {
                id: 2,
                nome: "Frango com Arroz",
                origem: "Base",
                ingredientes: [
                    { nome: "Peito de frango", quantidade: 300, unidade: "g" },
                    { nome: "Arroz", quantidade: 200, unidade: "g" },
                    { nome: "Cebola", quantidade: 1, unidade: "unidade" },
                    { nome: "√ìleo", quantidade: 3, unidade: "colheres" },
                    { nome: "Sal", quantidade: "a gosto" }
                ],
                doses: 4,
                tempo: 30,
                duracao_frigo: 3,
                custo_estimado: 4.00,
                instrucoes: [
                    "Cortar o frango em cubos",
                    "Refogar a cebola no √≥leo",
                    "Adicionar o frango e cozinhar",
                    "Cozinhar o arroz separadamente",
                    "Misturar tudo"
                ],
                tags: ["panela_grande", "prote√≠na"]
            },
            {
                id: 3,
                nome: "Ovos Mexidos",
                origem: "Emerg√™ncia",
                ingredientes: [
                    { nome: "Ovos", quantidade: 3, unidade: "unidades" },
                    { nome: "√ìleo", quantidade: 1, unidade: "colher" },
                    { nome: "Sal", quantidade: "a gosto" }
                ],
                doses: 1,
                tempo: 5,
                duracao_frigo: 0,
                custo_estimado: 0.75,
                instrucoes: [
                    "Bater os ovos num recipiente",
                    "Aquecer √≥leo na frigideira",
                    "Adicionar os ovos e mexer",
                    "Servir imediatamente"
                ],
                tags: ["r√°pido", "emerg√™ncia", "prote√≠na"]
            },
            {
                id: 4,
                nome: "Massa com Tomate e Frango",
                origem: "Base",
                ingredientes: [
                    { nome: "Massa", quantidade: 250, unidade: "g" },
                    { nome: "Tomate pelado (lata)", quantidade: 400, unidade: "g" },
                    { nome: "Frango picado", quantidade: 200, unidade: "g" },
                    { nome: "Cebola", quantidade: 1, unidade: "unidade" },
                    { nome: "√ìleo", quantidade: 2, unidade: "colheres" }
                ],
                doses: 4,
                tempo: 25,
                duracao_frigo: 3,
                custo_estimado: 3.50,
                instrucoes: [
                    "Cozinhar a massa conforme instru√ß√µes",
                    "Refogar cebola e frango",
                    "Adicionar tomate e temperar",
                    "Misturar com a massa"
                ],
                tags: ["panela_grande"]
            },
            {
                id: 5,
                nome: "Gr√£o com Cebola e Atum",
                origem: "Portuguesa",
                ingredientes: [
                    { nome: "Gr√£o cozido (lata)", quantidade: 400, unidade: "g" },
                    { nome: "Atum (lata)", quantidade: 120, unidade: "g" },
                    { nome: "Cebola", quantidade: 1, unidade: "unidade" },
                    { nome: "Azeite", quantidade: 3, unidade: "colheres" },
                    { nome: "Sal", quantidade: "a gosto" }
                ],
                doses: 3,
                tempo: 5,
                duracao_frigo: 2,
                custo_estimado: 2.50,
                instrucoes: [
                    "Escorrer o gr√£o e o atum",
                    "Cortar a cebola em rodelas finas",
                    "Misturar tudo com azeite",
                    "Temperar com sal"
                ],
                tags: ["minimalista", "frio", "portuguesa"]
            }
        ];

        // =======================
        // DADOS INICIAIS
        // =======================
        const INITIAL_ITEMS = [
            {
                id: 1,
                nome: "Peito de frango",
                categoria: "Prote√≠na",
                quantidade: "300g",
                estado: "cru",
                preco: 3.99,
                loja: "Albert Heijn",
                data_entrada: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)
            },
            {
                id: 2,
                nome: "Ovos",
                categoria: "Prote√≠na",
                quantidade: "6 unidades",
                estado: "cru",
                preco: 2.49,
                loja: "Lidl",
                data_entrada: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)
            },
            {
                id: 3,
                nome: "Feij√£o cozido (lata)",
                categoria: "Leguminosas",
                quantidade: "400g",
                estado: "aberto",
                preco: 0.79,
                loja: "Jumbo",
                data_entrada: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)
            },
            {
                id: 4,
                nome: "Arroz",
                categoria: "Hidratos",
                quantidade: "500g",
                estado: "seco",
                preco: 1.29,
                loja: "Lidl",
                data_entrada: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000)
            },
            {
                id: 5,
                nome: "Cebola",
                categoria: "Vegetais",
                quantidade: "3 unidades",
                estado: "cru",
                preco: 0.99,
                loja: "Albert Heijn",
                data_entrada: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)
            }
        ];

        // =======================
        // FUN√á√ïES DE C√ÅLCULO
        // =======================
        function calcularPrioridade(item) {
            const agora = new Date();
            const diasDesdeEntrada = Math.floor((agora - new Date(item.data_entrada)) / (1000 * 60 * 60 * 24));
            
            if (item.estado === "cozinhado") {
                if (diasDesdeEntrada >= 3) return { nivel: 1, texto: "Consumir J√Å", badge: "urgent" };
                if (diasDesdeEntrada === 2) return { nivel: 2, texto: "Hoje/amanh√£", badge: "warning" };
                return { nivel: 3, texto: "OK", badge: "ok" };
            }
            
            if (item.estado === "aberto") {
                if (diasDesdeEntrada >= 3) return { nivel: 2, texto: "Consumir breve", badge: "warning" };
                return { nivel: 3, texto: "OK", badge: "ok" };
            }
            
            if (item.estado === "cru") {
                if (diasDesdeEntrada >= 4) return { nivel: 2, texto: "Cozinhar j√°", badge: "warning" };
                return { nivel: 4, texto: "OK", badge: "ok" };
            }
            
            return { nivel: 5, texto: "Seguro", badge: "safe" };
        }

        function gerarSugestao(items, receitas) {
            const comidaPronta = items.filter(i => i.estado === "cozinhado" && calcularPrioridade(i).nivel >= 3);
            const itensUrgentes = items.filter(i => calcularPrioridade(i).nivel <= 2);
            
            if (comidaPronta.length > 0) {
                return {
                    tipo: "no-cook",
                    titulo: "‚úÖ N√£o cozinhar hoje",
                    mensagem: `Tens ${comidaPronta.length} refei√ß√£o/√µes pronta(s).`,
                    items: comidaPronta,
                    receita: null
                };
            }
            
            if (itensUrgentes.length > 0) {
                const receitaSugerida = receitas.find(r => 
                    r.tags.includes("panela_grande")
                ) || receitas[0];
                
                return {
                    tipo: "urgent",
                    titulo: "üî¥ Cozinhar hoje",
                    mensagem: `${itensUrgentes.length} item(ns) a estragar.`,
                    items: itensUrgentes,
                    receita: receitaSugerida
                };
            }
            
            const temProteina = items.some(i => i.categoria === "Prote√≠na" && i.estado === "cru");
            if (temProteina) {
                const receitaSugerida = receitas.find(r => 
                    r.tags.includes("panela_grande")
                ) || receitas[1];
                
                return {
                    tipo: "warning",
                    titulo: "‚ö†Ô∏è Sem comida pronta",
                    mensagem: "Tens ingredientes frescos dispon√≠veis.",
                    receita: receitaSugerida
                };
            }
            
            return {
                tipo: "ok",
                titulo: "üòå Invent√°rio baixo",
                mensagem: "Considera fazer compras em breve.",
                receita: null
            };
        }

        // =======================
        // COMPONENTE PRINCIPAL
        // =======================
        function App() {
            const [activeTab, setActiveTab] = useState('home');
            const [items, setItems] = useState(() => {
                const saved = localStorage.getItem('poupanca-holanda-items');
                return saved ? JSON.parse(saved).map(item => ({
                    ...item,
                    data_entrada: new Date(item.data_entrada)
                })) : INITIAL_ITEMS;
            });
            const [showSuggestion, setShowSuggestion] = useState(false);
            const [showAddModal, setShowAddModal] = useState(false);
            const [showScanModal, setShowScanModal] = useState(false);
            const [showRecipeModal, setShowRecipeModal] = useState(false);
            const [selectedRecipe, setSelectedRecipe] = useState(null);
            const [newItem, setNewItem] = useState({
                nome: "",
                categoria: "Prote√≠na",
                quantidade: "",
                estado: "cru",
                preco: "",
                loja: ""
            });
            const [scanning, setScanning] = useState(false);
            const scannerRef = useRef(null);
            
            useEffect(() => {
                localStorage.setItem('poupanca-holanda-items', JSON.stringify(items));
            }, [items]);
            
            const categorias = {
                "Prote√≠na": "ü•©",
                "Hidratos": "üçö",
                "Leguminosas": "ü´ò",
                "Vegetais": "ü•¨",
                "Extras": "üßÇ"
            };
            
            const custoTotal = items.reduce((sum, item) => sum + (parseFloat(item.preco) || 0), 0);
            const custoSemanal = custoTotal; // Simplificado por agora
            
            const sugestao = gerarSugestao(items, RECEITAS_BASE);
            
            const handleAddItem = () => {
                if (!newItem.nome || !newItem.quantidade) return;
                
                const novoItem = {
                    id: Date.now(),
                    ...newItem,
                    preco: parseFloat(newItem.preco) || 0,
                    data_entrada: new Date()
                };
                
                setItems([...items, novoItem]);
                setNewItem({ nome: "", categoria: "Prote√≠na", quantidade: "", estado: "cru", preco: "", loja: "" });
                setShowAddModal(false);
            };
            
            const handleDeleteItem = (id) => {
                if (confirm("Remover este item?")) {
                    setItems(items.filter(i => i.id !== id));
                }
            };
            
            const startScanner = () => {
                setScanning(true);
                setTimeout(() => {
                    const html5QrCode = new Html5Qrcode("reader");
                    html5QrCode.start(
                        { facingMode: "environment" },
                        { fps: 10, qrbox: 250 },
                        (decodedText) => {
                            html5QrCode.stop();
                            setScanning(false);
                            alert(`C√≥digo lido: ${decodedText}\n\nFuncionalidade completa em desenvolvimento.`);
                            setShowScanModal(false);
                        },
                        (error) => {
                            // Erros de scan s√£o normais, ignora
                        }
                    ).catch(err => {
                        alert("Erro ao aceder √† c√¢mara. Verifica as permiss√µes.");
                        setScanning(false);
                    });
                    
                    scannerRef.current = html5QrCode;
                }, 100);
            };
            
            const stopScanner = () => {
                if (scannerRef.current) {
                    scannerRef.current.stop();
                    setScanning(false);
                }
                setShowScanModal(false);
            };
            
            useEffect(() => {
                return () => {
                    if (scannerRef.current) {
                        scannerRef.current.stop();
                    }
                };
            }, []);
            
            const renderHome = () => (
                <>
                    <div className="stats">
                        <div className="stat-card">
                            <div className="stat-value">‚Ç¨{custoTotal.toFixed(2)}</div>
                            <div className="stat-label">Em stock</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-value">{items.length}</div>
                            <div className="stat-label">Produtos</div>
                        </div>
                    </div>
                    
                    <button 
                        className="btn-primary"
                        onClick={() => setShowSuggestion(!showSuggestion)}
                    >
                        <span>ü§î</span>
                        <span>{showSuggestion ? "Esconder" : "O que cozinho hoje?"}</span>
                    </button>
                    
                    {showSuggestion && (
                        <div className={`suggestion-box ${sugestao.tipo}`}>
                            <h2>{sugestao.titulo}</h2>
                            <p style={{marginBottom: '12px', fontSize: '14px'}}>{sugestao.mensagem}</p>
                            
                            {sugestao.items && sugestao.items.length > 0 && (
                                <ul style={{marginLeft: '20px', marginBottom: '12px', fontSize: '14px'}}>
                                    {sugestao.items.map(item => (
                                        <li key={item.id}>{item.nome} ({item.quantidade})</li>
                                    ))}
                                </ul>
                            )}
                            
                            {sugestao.receita && (
                                <div className="recipe-card" style={{marginTop: '12px', cursor: 'pointer'}}
                                     onClick={() => {
                                         setSelectedRecipe(sugestao.receita);
                                         setShowRecipeModal(true);
                                     }}>
                                    <div className="recipe-header">
                                        <div>
                                            <div className="recipe-title">{sugestao.receita.nome}</div>
                                            <div className="recipe-origin">{sugestao.receita.origem}</div>
                                        </div>
                                        <div className="recipe-cost">
                                            <div className="cost-total">‚Ç¨{sugestao.receita.custo_estimado.toFixed(2)}</div>
                                            <div className="cost-dose">‚Ç¨{(sugestao.receita.custo_estimado / sugestao.receita.doses).toFixed(2)}/dose</div>
                                        </div>
                                    </div>
                                    <div className="recipe-info">
                                        <span>‚è±Ô∏è {sugestao.receita.tempo} min</span>
                                        <span>üçΩÔ∏è {sugestao.receita.doses} doses</span>
                                        <span>‚ùÑÔ∏è {sugestao.receita.duracao_frigo} dias</span>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    <button 
                        className="btn-primary btn-scan"
                        onClick={() => setShowScanModal(true)}
                    >
                        <span>üì∑</span>
                        <span>Scan c√≥digo de barras</span>
                    </button>
                    
                    {Object.entries(categorias).map(([categoria, icon]) => {
                        const itensCategoria = items.filter(i => i.categoria === categoria);
                        if (itensCategoria.length === 0) return null;
                        
                        return (
                            <div key={categoria} className="category">
                                <h3>
                                    <span>{icon}</span>
                                    <span>{categoria}</span>
                                </h3>
                                {itensCategoria.map(item => {
                                    const prioridade = calcularPrioridade(item);
                                    return (
                                        <div key={item.id} className="item">
                                            <div className="item-info">
                                                <div className="item-name">{item.nome}</div>
                                                <div className="item-details">
                                                    {item.quantidade} ‚Ä¢ {item.estado} ‚Ä¢ ‚Ç¨{item.preco} ‚Ä¢ {item.loja}
                                                </div>
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '8px'}}>
                                                <span className={`badge badge-${prioridade.badge}`}>
                                                    {prioridade.texto}
                                                </span>
                                                <button 
                                                    className="btn-delete"
                                                    onClick={() => handleDeleteItem(item.id)}
                                                >
                                                    ‚úï
                                                </button>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        );
                    })}
                </>
            );
            
            const renderReceitas = () => (
                <>
                    <div style={{marginBottom: '16px'}}>
                        <h2 style={{fontSize: '20px', marginBottom: '12px'}}>Receitas Dispon√≠veis</h2>
                        <p style={{fontSize: '14px', color: '#666'}}>Clica numa receita para ver os detalhes</p>
                    </div>
                    
                    {RECEITAS_BASE.map(receita => (
                        <div key={receita.id} className="recipe-card" 
                             onClick={() => {
                                 setSelectedRecipe(receita);
                                 setShowRecipeModal(true);
                             }}
                             style={{cursor: 'pointer'}}>
                            <div className="recipe-header">
                                <div>
                                    <div className="recipe-title">{receita.nome}</div>
                                    <div className="recipe-origin">{receita.origem}</div>
                                </div>
                                <div className="recipe-cost">
                                    <div className="cost-total">‚Ç¨{receita.custo_estimado.toFixed(2)}</div>
                                    <div className="cost-dose">‚Ç¨{(receita.custo_estimado / receita.doses).toFixed(2)}/dose</div>
                                </div>
                            </div>
                            <div className="recipe-info">
                                <span>‚è±Ô∏è {receita.tempo} min</span>
                                <span>üçΩÔ∏è {receita.doses} doses</span>
                                <span>‚ùÑÔ∏è {receita.duracao_frigo} dias</span>
                            </div>
                            <div style={{marginTop: '8px', fontSize: '12px', color: '#666'}}>
                                {receita.tags.map(tag => (
                                    <span key={tag} style={{
                                        display: 'inline-block',
                                        background: '#f0f0f0',
                                        padding: '2px 8px',
                                        borderRadius: '4px',
                                        marginRight: '4px'
                                    }}>
                                        {tag}
                                    </span>
                                ))}
                            </div>
                        </div>
                    ))}
                </>
            );
            
            return (
                <>
                    <div className="header">
                        <h1>
                            <span>üá≥üá±</span>
                            <span>Poupan√ßa Holanda</span>
                        </h1>
                        <p>M√°xima poupan√ßa, zero desperd√≠cio</p>
                    </div>
                    
                    <div className="container">
                        {activeTab === 'home' && renderHome()}
                        {activeTab === 'receitas' && renderReceitas()}
                    </div>
                    
                    <div className="bottom-nav">
                        <button 
                            className={`nav-item ${activeTab === 'home' ? 'active' : ''}`}
                            onClick={() => setActiveTab('home')}
                        >
                            <div className="nav-icon">üè†</div>
                            <div className="nav-label">In√≠cio</div>
                        </button>
                        <button 
                            className={`nav-item ${activeTab === 'receitas' ? 'active' : ''}`}
                            onClick={() => setActiveTab('receitas')}
                        >
                            <div className="nav-icon">üìñ</div>
                            <div className="nav-label">Receitas</div>
                        </button>
                        <button 
                            className="nav-item"
                            onClick={() => setShowAddModal(true)}
                        >
                            <div className="nav-icon">‚ûï</div>
                            <div className="nav-label">Adicionar</div>
                        </button>
                    </div>
                    
                    {/* Modal Adicionar */}
                    {showAddModal && (
                        <div className="modal" onClick={() => setShowAddModal(false)}>
                            <div className="modal-content" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2>Adicionar Produto</h2>
                                    <button className="btn-close" onClick={() => setShowAddModal(false)}>√ó</button>
                                </div>
                                
                                <div className="form-group">
                                    <label>Nome</label>
                                    <input 
                                        type="text"
                                        value={newItem.nome}
                                        onChange={e => setNewItem({...newItem, nome: e.target.value})}
                                        placeholder="Ex: Peito de frango"
                                    />
                                </div>
                                
                                <div className="form-group">
                                    <label>Categoria</label>
                                    <select 
                                        value={newItem.categoria}
                                        onChange={e => setNewItem({...newItem, categoria: e.target.value})}
                                    >
                                        {Object.keys(categorias).map(cat => (
                                            <option key={cat} value={cat}>{cat}</option>
                                        ))}
                                    </select>
                                </div>
                                
                                <div className="form-group">
                                    <label>Quantidade</label>
                                    <input 
                                        type="text"
                                        value={newItem.quantidade}
                                        onChange={e => setNewItem({...newItem, quantidade: e.target.value})}
                                        placeholder="Ex: 500g, 3 unidades"
                                    />
                                </div>
                                
                                <div className="form-group">
                                    <label>Estado</label>
                                    <select 
                                        value={newItem.estado}
                                        onChange={e => setNewItem({...newItem, estado: e.target.value})}
                                    >
                                        <option value="cru">Cru</option>
                                        <option value="cozinhado">Cozinhado</option>
                                        <option value="aberto">Aberto</option>
                                        <option value="seco">Seco</option>
                                    </select>
                                </div>
                                
                                <div className="form-group">
                                    <label>Pre√ßo (‚Ç¨)</label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        value={newItem.preco}
                                        onChange={e => setNewItem({...newItem, preco: e.target.value})}
                                        placeholder="Ex: 3.99"
                                    />
                                </div>
                                
                                <div className="form-group">
                                    <label>Loja</label>
                                    <input 
                                        type="text"
                                        value={newItem.loja}
                                        onChange={e => setNewItem({...newItem, loja: e.target.value})}
                                        placeholder="Ex: Albert Heijn, Lidl"
                                    />
                                </div>
                                
                                <div className="btn-row">
                                    <button 
                                        className="btn-secondary"
                                        onClick={() => setShowAddModal(false)}
                                    >
                                        Cancelar
                                    </button>
                                    <button 
                                        className="btn-submit"
                                        onClick={handleAddItem}
                                    >
                                        Adicionar
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Modal Scanner */}
                    {showScanModal && (
                        <div className="modal" onClick={stopScanner}>
                            <div className="modal-content" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2>Scan C√≥digo de Barras</h2>
                                    <button className="btn-close" onClick={stopScanner}>√ó</button>
                                </div>
                                
                                <div id="reader"></div>
                                
                                {!scanning && (
                                    <button 
                                        className="btn-submit"
                                        style={{width: '100%', marginTop: '16px'}}
                                        onClick={startScanner}
                                    >
                                        Iniciar Scanner
                                    </button>
                                )}
                                
                                <div className="scanner-info">
                                    Aponta a c√¢mara para o c√≥digo de barras do produto
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Modal Receita */}
                    {showRecipeModal && selectedRecipe && (
                        <div className="modal" onClick={() => setShowRecipeModal(false)}>
                            <div className="modal-content" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2>{selectedRecipe.nome}</h2>
                                    <button className="btn-close" onClick={() => setShowRecipeModal(false)}>√ó</button>
                                </div>
                                
                                <div style={{marginBottom: '16px'}}>
                                    <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '12px'}}>
                                        <div>
                                            <div style={{fontSize: '13px', color: '#666'}}>Origem</div>
                                            <div style={{fontWeight: '500', color: '#9b59b6'}}>{selectedRecipe.origem}</div>
                                        </div>
                                        <div style={{textAlign: 'right'}}>
                                            <div style={{fontSize: '13px', color: '#666'}}>Custo Total</div>
                                            <div style={{fontSize: '20px', fontWeight: 'bold', color: '#27ae60'}}>
                                                ‚Ç¨{selectedRecipe.custo_estimado.toFixed(2)}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="recipe-info">
                                        <span>‚è±Ô∏è {selectedRecipe.tempo} min</span>
                                        <span>üçΩÔ∏è {selectedRecipe.doses} doses</span>
                                        <span>‚ùÑÔ∏è {selectedRecipe.duracao_frigo} dias</span>
                                    </div>
                                </div>
                                
                                <div className="form-group">
                                    <label>Ingredientes</label>
                                    <ul style={{marginLeft: '20px', fontSize: '14px', lineHeight: '1.8'}}>
                                        {selectedRecipe.ingredientes.map((ing, idx) => (
                                            <li key={idx}>
                                                {ing.nome} ‚Äî {ing.quantidade} {ing.unidade}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                                
                                <div className="form-group">
                                    <label>Instru√ß√µes</label>
                                    <ol style={{marginLeft: '20px', fontSize: '14px', lineHeight: '1.8'}}>
                                        {selectedRecipe.instrucoes.map((inst, idx) => (
                                            <li key={idx}>{inst}</li>
                                        ))}
                                    </ol>
                                </div>
                                
                                <button 
                                    className="btn-submit"
                                    style={{width: '100%', marginTop: '12px'}}
                                    onClick={() => setShowRecipeModal(false)}
                                >
                                    Fechar
                                </button>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <script>
        // Service Worker para PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(() => {
                console.log('Service worker not registered');
            });
        }
    </script>
</body>
</html>
